

<!doctype html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>
		
		Handling unusual account activities with multiple factors - Privacy Patterns
		
	</title>
  <meta name="description" content="Privacy patterns in software design">
  <meta name="author" content="Nick Doty and Mohit Gupta">
  <link rel="shortcut icon" href="/media/images/favicon.ico">
  
	
  <!-- CSS: implied media="all" -->
  <link href='http://fonts.googleapis.com/css?family=Lora:400,700' rel='stylesheet' type='text/css'>
  <link href="http://fonts.googleapis.com/css?family=Cuprum:regular&v1" rel="stylesheet" type="text/css" >
  <link href="http://fonts.googleapis.com/css?family=News+Cycle&subset=latin&v2" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/media/css/main.css?v=2">
	
	
	
	<!--[if lt IE 9]>
  <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>
	<body id="handling-unusual-account-activities-with-multiple-factors">
    <div id="container">

			<header>
  <div id="logo"><a href="/" title="Home">privacy<span class="highlight">patterns</span>.org</a></div>
  
  
<nav>
  <ul>
    <li><a href="/">Home</a> &bull; </li>
    <li><a href="/about/">About</a> &bull; </li>
    <li><a href="/patterns/">Patterns</a></li>
  </ul>
</nav>

  
</header>
  
<!-- 



<ul class="breadcrumbs">
	
		<li>
			<a href="/">Privacy Patterns</a>

			
				
				<span class="separator">&gt;</span>
				
			
		</li>
	
		<li>
			<a href="/patterns">Patterns</a>

			
		</li>
	
</ul>
    




 -->


      <div id="main" role="main">
			  






<div id="content">
  <p id="cats">
    Categories: 
      
        
          
<a href="/categories/control" class="control">control</a>
           &bull; 
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
<a href="/categories/notice" class="notice">notice</a>
           &bull; 
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
<a href="/categories/authentication" class="authentication">authentication</a>
           &bull; 
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
<a href="/categories/inform" class="inform">inform</a>
           &bull; 
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
<a href="/categories/notify" class="notify">notify</a>
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
  </p>
  <h1>
		
			Handling unusual account activities with multiple factors
		
	</h1>
	

	<div class="toc"><span class="toctitle">Contents</span><ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#context">Context</a></li>
<li><a href="#problem">Problem</a></li>
<li><a href="#solution">Solution</a></li>
<li><a href="#consequences">Consequences</a><ul>
<li><a href="#constraints">[Constraints]</a></li>
</ul>
</li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#sources">[Sources]</a></li>
</ul>
</li>
<li><a href="#general-comments">General&nbsp;Comments</a></li>
</ul>
</div>
<!--###[Also Known As]-->

<!-- All other names the pattern is known by.-->

<h2 id="summary"><a class="toclink" href="#summary">Summary</a></h2>
<!-- One short paragraph summarising the pattern.-->

<p>Use additional factors to notify users of unusual activities and authenticate 
when accounts may have been&nbsp;compromised.</p>
<!--intent-->

<p>For Internet services, prevent suspicious access to the account, and/or 
make the account owner aware of unusual&nbsp;activities.</p>
<h2 id="context"><a class="toclink" href="#context">Context</a></h2>
<!-- The situations in which the pattern may apply.-->

<p>Many Internet services are using password-based authentication which is
really convenient (compared to strong authentication) but has apparent&nbsp;drawbacks:</p>
<ul>
<li>
<p>The password itself does not&nbsp;change.</p>
<p>Unless the account owner changes the password, all sign-ins use the
same identity-password combination. If the password is stolen by a
malicious party through some means, it can be reused until it is&nbsp;changed.</p>
</li>
<li>
<p>The password can be&nbsp;cracked.</p>
<p>Many account owners tend to use weak passwords that can be
brute-force attacked online. Sometimes the hacker can obtain the
database dump which contains hashed passwords, which can be
brute-forced&nbsp;offline.</p>
</li>
<li>
<p>The account owner has no way to ensure their exclusive possession of
    the&nbsp;password.</p>
<p>The account owner has no evidence if the password is stolen by a
malicious&nbsp;party.</p>
</li>
<li>
<p>The only way to control who can access is to reset the&nbsp;password.</p>
<p>As a result, if the account owner want to ensure only they have the
password, they can only reset the password. In some scenarios,
resetting the password is not&nbsp;enough.</p>
</li>
<li>
<p>The password can be seen by people&nbsp;around.</p>
<p>When the account owner enters the password on a computer keyboard or
the screen of a mobile device (mobile phone / tablet), people around
have the ability to snoop the password and record&nbsp;it.</p>
</li>
</ul>
<p>Thus, a service can't tell if the user is legitimate even if the
identity-password combination provided by the user is correct.
Fortunately, a service can usually receive some meta information to help
determine if an activity is unusual. In case of such unusual activities,
a service needs to prevent suspicious access to an account, and/or
inform the account owner of the unusual&nbsp;activities.</p>
<h2 id="problem"><a class="toclink" href="#problem">Problem</a></h2>
<!-- The problem a pattern addresses, including a list of forces describing why a problem might be difficult to solve.-->

<p>How can a service that uses username-password authentication and
involves a lot of privacy identify unusual sign-ins, confirm the
identify of the user, and inform the account owner of such unusual&nbsp;activities?</p>
<!--forces/concerns-->

<p>The pattern described here is a tradeoff between pure password
authentication which is insecure, and pure multi-factor authentication
which is inconvenient. It increases privacy at the cost of&nbsp;usability.</p>
<p>The fallback multi-factor authentication should be picked carefully with
the understanding of the&nbsp;service.</p>
<ul>
<li>In the above example, Facebook makes use of its resource of
    friendship and photos. Their decision is based on the assumption
    that it is very unlikely for a hacker to recognize the friends.
    Actually the assumption may not hold true in some scenarios, because
    many of the photos are public and can be viewed under another
    account, or can be identified with the help from a large-scale
    tagged photo collection and machine&nbsp;learning.</li>
<li>Persuading the user into carrying a hardware token everywhere only
    for occasional multi-factor authentication may be difficult, but it
    might worth the effort for financial&nbsp;services.</li>
</ul>
<p>The strategy to identify unusual activities should also be considered
seriously. It should be also to identify most of the activities, with a
false positive rate that is not too high. It should balance the cost of
multi-factor&nbsp;authentication.</p>
<h2 id="solution"><a class="toclink" href="#solution">Solution</a></h2>
<!-- A concise description of how the pattern addresses the problem.-->

<p>First, the service should be able to identify unusual sign-ins. Then the
service may use multi-factor authentication to confirm the identity of
the&nbsp;user.</p>
<p>The user should be informed of unusual activities, or have some ways to
see recent events, and even do&nbsp;something.</p>
<ul>
<li>Identify Unusual&nbsp;Activities</li>
</ul>
<p>Today, a web service may appear as a website or an application on the
user's devices (including mobile devices and the PCs). The service can
use meta information to determine if a sign-in with the correct
username-password combination is&nbsp;suspicious.</p>
<p>The strategies described here has both false positives and false&nbsp;negatives.</p>
<ul>
<li>A&nbsp;Website</li>
</ul>
<p>Typically, a sign-in to a website is in the form of an HTTP request,
which contains many customized settings of the browser, including the
type of the browser and operating system as well as the architecture
(<code>User-Agent</code> header), the Cookie (<code>Cookie</code> header), language
preferences (<code>Accept-Languages</code> header). Apart from these, the website
can get the IP address of the user, which may be mapped to a certain
country/area through&nbsp;GeoIP.</p>
<p>The above meta information can be used to tell if a browser is <em>new</em> to
the website. The website can have its rules to determine if an access is
<em>suspicious</em>, for example, an access from a new country / browser /
operating system is considered&nbsp;suspicious.</p>
<ul>
<li>An&nbsp;Application</li>
</ul>
<p>By running native code, the application can collect some identifiers of
the machine, including the operating system environment settings (e.g.
the list of running processes), the hardware parameters (such as the ID
of the CPU), and device UUIDs (provided by mobile operating systems like
iOS). By completing a network request, the service also retrieves the IP
address of the&nbsp;machine.</p>
<p>The above meta information can be used to tell if a machine is <em>new</em> to
the service. The service can have its rules to determine if a sign-in is
<em>suspicious</em>, for example, an access from a new country / machine /
operating system is considered&nbsp;suspicious.</p>
<ul>
<li>Require Multi-factor&nbsp;Authentication</li>
</ul>
<p>In case of a suspicious sign-in, multi-factor authentication may be a
way to let the legitimate user in. The service can request one more
authentication except password, such&nbsp;as:</p>
<ul>
<li>
<p>A software&nbsp;token</p>
<p>Examples include Google Authenticator which runs on mobile phones
and implements RFC6238 TOTP security&nbsp;tokens..</p>
</li>
<li>
<p>A hardware token&nbsp;(disconnected)</p>
<p>Examples include a token issued by a bank which displays digits,
which is similar to a software&nbsp;token.</p>
</li>
<li>
<p>A hardware token&nbsp;(connected)</p>
<p>The token may exchange a longer secondary password than the previous
one, which means it's&nbsp;safer.</p>
</li>
<li>
<p>Personal data like date of birth,&nbsp;SSN</p>
<p>Obviously not a good choice here because it cannot be&nbsp;changed.</p>
</li>
<li>
<p>An one-time password (OTP) sent to the registered E-mail address /
    mobile&nbsp;phone</p>
<p>Depending the type of the service, maybe the user uses the same
password for the E-mail address, or maybe the mobile phone is stolen
and the service runs on the mobile&nbsp;phone.</p>
</li>
</ul>
<p>Using multi-factor authentication only in case of suspicious sign-ins is
more convenient to using it all the time, but is less&nbsp;secure.</p>
<ul>
<li>Notify Account Holders of Unusual&nbsp;Activities</li>
</ul>
<p>When an suspicious sign-in is detected, it may be a sign that the
password has already been leaked. Depending on the type of the service,
it can notify the user about the suspicious sign-in through E-mail,
telephone, or other&nbsp;means.</p>
<p>Here the immediate notification can also be used in the multi-factor&nbsp;authentication.</p>
<p>For services that can be logged on from multiple devices at the same
time, the user should be able to check the existence of other sessions,
and review recent sign-in&nbsp;events.</p>
<!--###[Structure]-->

<!--A detailed specification of the structural aspects of the pattern. A class diagram if applicable.-->

<!--###[Implementation]-->

<!--Guidelines for implementing the pattern; code fragments; suggested PETS; policy fragments.-->

<h2 id="consequences"><a class="toclink" href="#consequences">Consequences</a></h2>
<!--The advantages (benefits) and disadvantages (liabilities) of applying the pattern.-->

<h3 id="constraints"><a class="toclink" href="#constraints">[Constraints]</a></h3>
<!-- limitations as a consequence of applying the pattern.-->

<p>This pattern has some limitations. For example, it relies on accurate
identification of suspicious sign-ins based on meta information, where
the meta information including the IP address can be spoofed by an
experienced&nbsp;attacker.</p>
<p>If the fallback multi-factor authentication only happens occasionally to
the legitimate account owner, they may be unprepared to such
authentication, leading to a decreased&nbsp;usability.</p>
<h2 id="examples"><a class="toclink" href="#examples">Examples</a></h2>
<!--Motivational example to see how the pattern is applied.-->

<ol>
<li>Gmail</li>
</ol>
<p>Gmail displays information about other sessions (if any) in the footer,
 linking to a page named "Activity on this account" which lists other
 sessions and recent activities to the Gmail account. The user has the
 option to sign out other&nbsp;sessions.</p>
<p>In case of annoying false positives, the user may choose to disable the
 alert for unusual activity. The disable takes about a week, "to make
 sure the bad guys aren't the ones who turned off your&nbsp;alerts."</p>
<ol>
<li>Facebook</li>
</ol>
<p>When Facebook detects an unusual sign-in, it shows <em>social
 authentication</em> that displays a few pictures of the user's friends and
 asks the user to name the person in those&nbsp;photos.</p>
<ol>
<li>Dropbox</li>
</ol>
<p>The <em>Security</em> tab of the <em>Settings</em> of the Dropbox website displays all
 web browser sessions logged in to the account, and enables the user to
 log out one or more of them. The name of the browser, operating system,
 and the IP address and corresponding country are displayed to help the
 user make a&nbsp;choice.</p>
<p>It also displays all devices that are linked to the account, and allows
 the user to unlink one or more of&nbsp;them.</p>
<!--###[Known Uses]-->

<!-- Pointers to various applications of the pattern.-->

<!--##See Also-->

<!-- Any pointers to relevant information, not contained in the subfields below.-->

<!--###[Related Patterns]-->

<!-- Supporting and conflicting patterns-->

<h3 id="sources"><a class="toclink" href="#sources">[Sources]</a></h3>
<!-- References to the original source of the pattern.-->

<ul>
<li>Polakis, I., Lancini, M., Kontaxis, G., Maggi, F., Ioannidis, S.,
    Keromytis, A. D., <span class="amp">&amp;</span> Zanero, S. (2012, December). <strong>All Your Face are
    Belong to Us: Breaking Facebook's Social Authentication</strong>. In
    <em>Proceedings of the 28th Annual Computer Security Applications
    Conference</em> (pp. 399-408).&nbsp;ACM.</li>
</ul>
<h2 id="general-comments"><a class="toclink" href="#general-comments">General&nbsp;Comments</a></h2>
<!-- Separate discussion on the pattern.-->

<ul>
<li>Determining the&nbsp;Scope</li>
</ul>
<p>I started with Gmail's display of account activities. It displays
unusual activities regarding an account, which involves identifying
unusual activities where the password entered is correct. For some other
services, correct passwords can be rejected from a new device /&nbsp;location.</p>
<p>So, the scope of this pattern is to handle unusual activities (including&nbsp;sign-ins).</p>
<ul>
<li>Relevant&nbsp;Information</li>
</ul>
<p>This pattern includes multi-factor authentication and two-step
authentication, which are well studied. But the general topic about
informing the user of unusual activities seems to be lack of&nbsp;literature.</p>
<!--##Tags-->

<!-- User definable descriptors for additional correlation.-->

	
	
  <p id="comments_link">
    Corrections or additions? <a href="https://github.com/privacypatterns/patterns/blob/master/patterns/Unusual-activities.md" target="_blank">Contribute on GitHub.</a>
  </p>
  

  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'privacypatterns';
      // var disqus_developer = 1; // Remove this when going live

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>



      </div>
			<footer>
	<p>
		<a rel="license" class="license" href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons License" src="http://i.creativecommons.org/l/by/3.0/80x15.png" /></a>
		Privacy patterns are licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution license</a>.
	<br>Contribute on <a href="https://github.com/privacypatterns">GitHub</a>. Read our <a href="/about/policy" title="Privacy Policy">privacy and contribution policy</a>.
	</p>
	<p class="berkeley">UC Berkeley <img id="iman" src="/media/images/I_School_logo_i.png" height="30px" /> School of Information</p> 
</footer>


		</div>
    <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary --
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
    <script>window.jQuery || document.write("<script src='js/libs/jquery-1.5.1.min.js'>\x3C/script>")</script>
    
  	
  	
    -->
    <script>
      var _gaq=[['_setAccount','UA-24350461-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
	</body>
</html>

